// File: columnsSettings.js
function ColumnsSettings(a,b,c,d,e,f,g){this._htmlDir=a,this._containerId=b,this._tab=c,this._id=d,this._message=e,this._intMaxCheckboxes=f,this._intMinOptCheckboxes=g,this._allCheckboxesSelector="#"+this._tab+"ColsSelect"+this._id+' input[value!="tableAdjust"]'}ColumnsSettings.prototype.updateMessage=function(a){var b=this;$("#colSelectPopup_"+b._id+' [id="'+b._tab+'ColsSelectMessage"]').html(b._message.replace("X",a))},ColumnsSettings.prototype.onCheckboxClick=function(a){var b=this;$(a).is(":not(:checked)")&&$(a).is("[data-required]")&&+$(b._allCheckboxesSelector+"[data-required][checked]").length<+$(a).attr("data-required")?$(a).attr("checked","checked"):!$(a).is("[data-required]")&&!$(a).is(":checked")&&+$(b._allCheckboxesSelector+":not([data-required])[checked]").length<+b._intMinOptCheckboxes?$(a).attr("checked","checked"):$(a).is(":checked")&&+$(b._allCheckboxesSelector+"[checked]").length>+b._intMaxCheckboxes&&$(a).removeAttr("checked");var c=+$(b._allCheckboxesSelector+"[checked]").length,d=$(b._allCheckboxesSelector+":not(:checked)");c>=+b._intMaxCheckboxes?(d.attr("disabled",!0),d.removeClass("pointer"),d.parent().find("label").removeClass("pointer")):(d.removeAttr("disabled"),d.addClass("pointer"),d.parent().find("label").addClass("pointer")),b.updateMessage(c)},ColumnsSettings.prototype.restoreInitialSettings=function(){var a=this;$(a._allCheckboxesSelector).each(function(){var b=$(this).attr("data-column-name"),c="#"+a._containerId+' table th[data-column-name="'+b+'"]';$(c).is(":hidden")?$(this).removeAttr("checked"):$(this).attr("checked","checked")});var b=+$(a._allCheckboxesSelector+"[checked]").length;void 0===$("#"+a._containerId+" table").attr("style")?$("#"+a._tab+"ColsSelect"+a._id+' input[value="tableAdjust"]').attr("checked","checked"):$("#"+a._tab+"ColsSelect"+a._id+' input[value="tableAdjust"]').removeAttr("checked"),a.updateMessage(b)},ColumnsSettings.prototype.hideColumnSelectionBox=function(){var a=this,b="ltr"===a._htmlDir?{right:"-4px"}:{left:"-4px"};$(".colSelectPopup").addClass("displayNone"),$(".pressed").removeClass("pressed").animate(b,200),$("body").off("click.ColumnSelectionBox")},ColumnsSettings.prototype.showColumnSelectionBox=function(){var a=this,b=$("#colSelectIcon_"+a._id),c=b.hasClass("pressed");a.hideColumnSelectionBox(),c||setTimeout(function(){objDirection="ltr"===a._htmlDir?{right:"0px"}:{left:"0px"},b.addClass("pressed").animate(objDirection,200,function(){var b=$("#colSelectPopup_"+a._id).removeClass("displayNone"),c=$("#"+a._containerId+" table").width(),d=b.width();d>=c?b.addClass("reverse"):b.removeClass("reverse"),$("body").on("click.ColumnSelectionBox",function(c){var d=$(c.target);$(c.target)===b[0]||d.parents("#colSelectPopup_"+a._id).length||a.hideColumnSelectionBox()})})},200)},ColumnsSettings.prototype.colSelectIconClick=function(a){a.stopPropagation();var b=this;b.restoreInitialSettings(),b.showColumnSelectionBox()},ColumnsSettings.prototype.profilePopupReset=function(){var a=this,b="ltr"===a._htmlDir?{right:"-4px"}:{left:"-4px"};$(".colSelectPopup").addClass("displayNone"),$(".pressed").removeClass("pressed").animate(b,200)},ColumnsSettings.prototype.onApplyClick=function(a,b){var c=this;a?a.call(c,b):c.showHideColumns(b),c.profilePopupReset(),c.restoreInitialSettings()},ColumnsSettings.prototype.getSelectedColumns=function(){var a=[];$(this._allCheckboxesSelector+":checked").each(function(b,c){var d=$(this).attr("data-column-name");a.push(d)});var b=$("#"+this._id+"_tableAdjust");return(b.is(":checked")||0===b.length)&&a.push("tableAdjust"),a},ColumnsSettings.prototype.showHideColumns=function(a){var b=this.getSelectedColumns(),c=$("#"+this._containerId+" table"),d=["th","td"];for(var e in d){var f=d[e];c.find(f+"[data-column-name]").each(function(){var a=$(this),c=a.attr("data-column-name");-1!=b.indexOf(c)?a.removeClass("displayNone"):a.addClass("displayNone")})}var g=b.indexOf("tableAdjust");-1===g?c.css("width","auto"):c.removeAttr("style"),0===$("#"+this._id+"_tableAdjust").length&&b.splice(g,1),a&&a.ajaxUrl&&$.post(a.ajaxUrl,{columns:b},function(a){console.log(a)})};