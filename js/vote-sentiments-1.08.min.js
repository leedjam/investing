// File: vote-sentiments.js
window.initializeVoteSentiments=function(){function a(a){var b={action:"add_comment",type:a,conviction:"firm",timeframe:2592e3,pair_ID:i.pairID,pair_category:i.sentimentCategory};window.siteData.userLoggedIn?($(".instrumentsSentiments").addClass("noFlow"),$(".instrumentsSentiments .left, .instrumentsSentiments .right").addClass("fadeOut"),f(a),$.get("/common/sentiments/sentiments_ajax.php",b,$.noop)):(overlay.authCompleteAction={type:"sentiment",actionData:b},overlay.overlayLogin())}function b(){var b,c=$(this).attr("name").is("bull");a(c?"bullish":"bearish"),b=(c?"Bull":"Bear")+" - "+(siteData.userLoggedIn?"Logged In":"Not Logged In"),ga("allSitesTracker.send","event","Social Buttons","My Sentiment",b)}function c(a){var b,c=$('.newSentimentsButton[name="bull"]').data("count"),d=$('.newSentimentsButton[name="bear"]').data("count");return a?d++:c++,b=Math.floor(c/(d+c)*100),{bearish:100-b,bullish:b}}function d(a,b){var c=b?i.votedBearish:i.votedBullish;return c=c.replace("%s",'<a href="'+i.link+'" class="bold blueLinkArrow" target="_blank">'+i.mySentiments+"</a>"),a.find(".js-icon-class").addClass(b?"newBearIcon2":"newBullIcon2"),a.find(".js-text").html(c),a}function e(a,b){return a.find(".js-bull-percent").text(b.bullish+"%"),a.find(".js-bear-percent").text(b.bearish+"%").css("width",b.bearish+"%"),!b.bearish&&a.find(".js-bear-percent").css("border","none"),a}function f(a){var b=a.is("bearish");$(".instrumentsSentiments .left, .instrumentsSentiments .right").addClass("bottomHide"),setTimeout(function(){$(".js-sentiments-right").html(e($($(".js-stats-template").html()),c(b))).removeClass("fadeOut").addClass("backUp"),$(".js-sentiments-left").html(d($($(".js-thanks-template").html()),b)).removeClass("fadeOut").addClass("backUp")},500)}var g=$(".js-sentiment-btn"),h=g.hasClass("disabled"),i=window.sentimentsTranslations;!h&&g.on("click",b)},window.initializeVoteSentiments();