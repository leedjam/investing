// File: markets.js
function marketsLoading(a){$("#"+a).html($("#fx-loading-template").html())}function ajaxSuccessParsing(a,b,c,d){var e=function(a,b){var d=c;d.html(a),$.isArray(b)&&b.length>0&&$(window).trigger("socketNewData",[b])};$.ajax({dataType:"json",url:a,data:b,success:function(a){null===a?e(a,[]):e(a.HTML,a.pids),d&&d()}})}function marketsSectionSelector(a){var b=$(a).attr("id");marketsLoading("mainMarketsContent"),"adrs"==b?ajaxSuccessParsing("/equities/service/LoadMarkersAdrs",{section:b,smlID:$("#smlID").val()},$("#mainMarketsContent")):ajaxSuccessParsing("/markets/SectionChange",{section:b,smlID:$("#smlID").val(),sid:$("#sid").val()},$("#mainMarketsContent"))}function primarySectors(){$("html,body").animate({scrollTop:$("#MarketsTabs").offset().top},"fast"),$("#marketsSectionSelector #overview").removeClass("selected"),$("#marketsSectionSelector #indices").addClass("selected"),marketsLoading("mainMarketsContent"),ajaxSuccessParsing("/markets/SectionChange",{section:"indices",smlID:$("#smlID").val(),sid:$("#sid").val(),primarySectors:"on"},$("#mainMarketsContent"))}function stocksTab(){$("html,body").animate({scrollTop:$("#MarketsTabs").offset().top},"fast"),$("#marketsSectionSelector #overview").removeClass("selected"),$("#marketsSectionSelector #stocks").addClass("selected"),marketsLoading("mainMarketsContent"),ajaxSuccessParsing("/markets/SectionChange",{section:"stocks",smlID:$("#smlID").val(),sid:$("#sid").val()},$("#mainMarketsContent"))}function marketsOverviewChangeIndex(a){var b=$(a).attr("id");if("all"==b)var c=$("#main_indices_ids").val();else var c="";marketsLoading("components_block"),ajaxSuccessParsing("/markets/OverviewChangeIndex",{index_ID:b,country_id:$("#countryID").val(),main_indices_ids:c,sid:$("#sid").val()},$("#components_block"))}function showFilters(){$("#filtersWrapper").slideToggle("slow"),$("#filterStateAnchor").hasClass("active")?$("#filterStateAnchor").removeClass("active"):$("#filterStateAnchor").addClass("active")}function doIndicesFilter(a,b){var c="price";if("cb"==a&&0==$(".countryOption INPUT:checked").length)return void $(b).attr("checked","checked");if("btn"==a){if($(b).hasClass("toggled"))return;$(b).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")})}if(marketsLoading("marketInnerContent"),$("#filter_majorIndices").is(":checked"))var d="on";else var d="off";if($("#filter_additionalIndices").is(":checked"))var e="on";else var e="off";if($("#filter_primarySectors").is(":checked"))var f="on";else var f="off";if($("#filter_otherIndices").is(":checked"))var g="on";else var g="off";$("#filter_price").hasClass("toggled")&&(c="price"),$("#filter_performance").hasClass("toggled")&&(c="performance"),$("#filter_technical").hasClass("toggled")&&(c="technical");var h={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:c,majorIndices:d,additionalIndices:e,primarySectors:f,otherIndices:g};ajaxSuccessParsing("/markets/IndicesFilter",h,$("#marketInnerContent"))}function doStocksFilter(a,b){var c="price";if("btn"==a){if($(b).hasClass("toggled"))return;$(b).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")})}marketsLoading("marketInnerContent"),$("#filter_price").hasClass("toggled")&&(c="price"),$("#filter_performance").hasClass("toggled")&&(c="performance"),$("#filter_technical").hasClass("toggled")&&(c="technical"),$("#filter_fundamental").hasClass("toggled")&&(c="fundamental");var d={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:c,index_id:$("#stocksFilter option:selected").attr("id")};ajaxSuccessParsing("/markets/StocksFilter",d,$("#marketInnerContent"))}function doBondsFilter(a){var b="yield";if(!$(a).hasClass("toggled")){$(a).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")}),marketsLoading("marketInnerContent"),$("#filter_yield").hasClass("toggled")&&(b="yield"),$("#filter_performance").hasClass("toggled")&&(b="performance"),$("#filter_technical").hasClass("toggled")&&(b="technical");var c={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:b};ajaxSuccessParsing("/markets/BondsFilter",c,$("#marketInnerContent"))}}function doFuturesFilter(a,b){var c,d="price",e=$(b);if("btn"===a){if(e.hasClass("toggled"))return;e.addClass("toggled").siblings().removeClass("toggled")}else if("cb"===a){if(e.prop("disabled"))return;e.prop("disabled",!0),c=function(){e.prop("disabled",!1)}}marketsLoading("marketInnerContent"),$("#filter_price").hasClass("toggled")&&(d="price"),$("#filter_performance").hasClass("toggled")&&(d="performance"),$("#filter_technical").hasClass("toggled")&&(d="technical"),$("#filter_specifications").hasClass("toggled")&&(d="specifications");var f={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:d,filter_indices:$("#filter_indices").is(":checked")?"on":"off",filter_commodities:$("#filter_commodities").is(":checked")?"on":"off",filter_financial_futures:$("#filter_financial_futures").is(":checked")?"on":"off",filter_futures_stocks:$("#filter_futures_stocks").is(":checked")?"on":"off"};ajaxSuccessParsing("/markets/FuturesFilter",f,$("#marketInnerContent"),c)}function doETFsFilter(a,b){var c="price",d=$("#etf_asset option:selected").attr("value"),e=$("#etf_filter option:selected").attr("value");if("btn"==a){if($(b).hasClass("toggled"))return;$(b).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")})}"form"==a&&(0==d?$("#filterStateButton").hasClass("filtersOnLight")&&$("#filterStateButton").removeClass("filtersOnLight").addClass("filtersOffLight"):$("#filterStateButton").hasClass("filtersOffLight")&&$("#filterStateButton").removeClass("filtersOffLight").addClass("filtersOnLight")),marketsLoading("marketInnerContent"),$("#filter_price").hasClass("toggled")&&(c="price"),$("#filter_performance").hasClass("toggled")&&(c="performance"),$("#filter_technical").hasClass("toggled")&&(c="technical"),$("#filter_fundamental").hasClass("toggled")&&(c="fundamental");var f={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:c,asset_type:d,filter_id:e};ajaxSuccessParsing("/markets/ETFsFilter",f,$("#marketInnerContent"))}function doADRsFilter(a,b){var c="price",d=$("#etf_asset option:selected").attr("value"),e=$("#etf_filter option:selected").attr("value");if("btn"==a){if($(b).hasClass("toggled"))return;$(b).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")})}"form"==a&&(0==d?$("#filterStateButton").hasClass("filtersOnLight")&&$("#filterStateButton").removeClass("filtersOnLight").addClass("filtersOffLight"):$("#filterStateButton").hasClass("filtersOffLight")&&$("#filterStateButton").removeClass("filtersOffLight").addClass("filtersOnLight")),marketsLoading("marketInnerContent"),$("#filter_price").hasClass("toggled")&&(c="price"),$("#filter_performance").hasClass("toggled")&&(c="performance"),$("#filter_technical").hasClass("toggled")&&(c="technical"),$("#filter_fundamental").hasClass("toggled")&&(c="fundamental");var f={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:c,asset_type:d,filter_id:e,type:"markets"};ajaxSuccessParsing("/equities/service/ADRsFilter",f,$("#marketInnerContent"))}function doForexFilter(a,b){var c="price";if("btn"==a){if($(b).hasClass("toggled"))return;$(b).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")})}marketsLoading("marketInnerContent"),$("#filter_price").hasClass("toggled")&&(c="price"),$("#filter_performance").hasClass("toggled")&&(c="performance"),$("#filter_technical").hasClass("toggled")&&(c="technical");var d={smlID:$("#smlID").val(),sid:$("#sid").val(),tabletype:c};ajaxSuccessParsing("/markets/ForexFilter",d,$("#marketInnerContent"))}function optionsTypeSelector(a){var b=$(a).attr("id");$(a).hasClass("toggled")||($(a).addClass("toggled").siblings().each(function(){$(this).hasClass("toggled")&&$(this).removeClass("toggled")}),marketsLoading("marketInnerContent"),ajaxSuccessParsing("/markets/OptionsFilter",{type:b,smlID:$("#smlID").val(),sid:$("#sid").val()},$("#marketInnerContent")))}