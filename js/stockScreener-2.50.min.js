// File: FilterHeap.js
var FiltersHeap=function(){var a="a",b="d",c=$(".js-primary-filters"),d="-1",e=1,f={col:"eq_market_cap",dir:b},g=!1,h={country:"5",exchange:d,sector:d,industry:d,equityType:d,other:{}},i="|",j=",",k="::",l="a",m=";",n=">",o="<",p=function(a){"country"!==a||g||delete h.exchange,void 0===h.other&&(h.other={})},q=function(a){!isNaN(e)&&e>0&&(e=a)},r=function(c,d){f.col=c,f.dir=d===a||d===b?d:a},s=function(){return f},t=function(){return e},u=function(a,b){if(!a)throw new Error("Invalid key type "+a+" given to filter stack");h[a]=b,p(a)},v=function(a,b,c){if(!a)throw new Error("Invalid key type "+a+" given to filter stack");if(!b&&0!==b)throw new Error("Invalid minimal value given to filter stack range");if(!c&&0!==c)throw new Error("Invalid maximal value given to filter stack range");void 0===h.other[a]?h.other[a]={min:b,max:c}:(h.other[a].min=b,h.other[a].max=c),p(a)},w=function(a){if(!a)throw new Error("Invalid key type "+a+" given to filter stack");void 0===h[a]?delete h.other[a]:delete h[a]},x=function(){var a=$.extend(!0,{},h);for(var b in a)a[b]===d?(a[b]=[],c.find(".js-filter-dropdown[data-filter-type="+b+"] li").each(function(){if(this.getAttribute("data-value")===d)return!0;a[b].push(this.getAttribute("data-value"))})):a[b]=[a[b]];return a=$.extend(a,a.other[0]),delete a.other,a},y=function(c){var d=new RegExp("(["+n+o+"])([\\w\\.\\-]+)");if(d.test(c)){var e=d.exec(c),g=e[0];switch(e[1]){case n:f.dir=a;break;case o:f.dir=b}f.col=e[2],c=c.replace(g,"")}return c};return{addFilterValue:u,addFilterRange:v,getFilterData:x,getFilterValue:function(a){if(!a)throw new Error("Invalid key type "+a+" given to filter stack");return h[a]},removeFilter:w,serialize:function(){var c=x(),d="",g="";for(var p in c){d+=g+p+k;var q="";if((h.hasOwnProperty(p)&&"other"!==p||"exchange"===p)&&c[p].length>1)d+=q+l,q=j,g=i;else{for(var r in c[p])d+=q+c[p][r],q=j;g=i}}if(""!==f.col){switch(f.dir){case a:d+=n;break;case b:d+=o}d+=f.col}return d+m+e},unserialize:function(a){var b="invalid serialized data in stock screener";a=y(a);var c=a.split(m);if(2!==c.length)throw new Error(b);if(isNaN(c[1])||c[1]<0)throw new Error(b);q(c[1]);var e=c[0].split(i);for(var f in e){var g=e[f].split(k);if(2!==g.length)throw new Error(b);var n=g[1].split(j);h.hasOwnProperty(g[0])&&"other"!==g[0]||"exchange"===g[0]?u(g[0],n[0]===l?d:n[0]):2!==n.length||v(g[0],n[0],n[1])}},setPageNum:q,getPageNum:t,setOrder:r,getOrder:s,setUpdateByURL:function(a){g=a},getRangeFilters:function(){return $.extend(!0,{},h.other)},ASC_ORDER:a,DESC_ORDER:b}}();
// File: FilterStocks.js
var FilterStocks=function(){function a(){return!!$(".js-stockscreener-hp").length}function b(a){a.industry=a.industry.join(","),a.sector=a.sector.join(","),a.equityType=a.equityType.join(",")}function c(a){if(!z){if(!r)throw new Error("Search disabled, not yet initialized.");if("csp"!=a){var c=FiltersHeap.getFilterData();c.pn=FiltersHeap.getPageNum();var d=FiltersHeap.getOrder();0!==$.trim(d.col).length&&(c.order=d),c.tab=a,b(c)}else{var c=new Object;c.tab=a,c.pairs_list=k()}window.stockScreenerDownloadParams=$.param(c),siteData.userLoggedIn?document.location.href="/stock-screener/Service/downloadData?download=1&"+window.stockScreenerDownloadParams:(overlay.overlayLogin(),overlay.authCompleteAction={type:"stockScreenerData",actionData:window.stockScreenerDownloadParams})}}function d(){return $.makeArray($("#colSelectPopup_stock_screener ul>li>input:checked").map(function(){return this.value}).filter(function(){return this.isnt("name_trans")}))}function e(a){R.find("th:not(.flag, [data-column-name=name_trans])")._hide(),R.find("th.icon")._toggleShow(W.is("overview")||W.is("js-tab-overview")),-1==a.indexOf("name_trans")?R.find("th[data-column-name='name_trans']").__hide():R.find("th[data-column-name='name_trans']").__show(),a.forEach(function(a){R.find('th[data-column-name="'+a+'"]')._show()})}function f(a){var b,c,d,f,i=[];nameChecked=$("#resultsContainerColsSelectstock_screener").find("input[data-column-name]").attr("checked"),c=W.is("overview")&&-1==a.indexOf("name_trans")&&"checked"==nameChecked?["name_trans"].concat(a):a,S.empty(),y.hits.forEach(function(a){i.push("<tr>"),i.push('<td class="flag"><span class="ceFlags '+a.viewData.flag+'"></span></td>'),c.forEach(function(c){d=c.isnt("name_trans"),(W.is("js-tab-overview")||W.is("performance")||W.is("overview"))&&"number"==typeof a[c]&&(a[c]=F(a[c])),b=c.substr(0,9).is("viewData.")?a.viewData[c.substr(9)]:a[c+(Y[W]||"")],c.is("name_trans")&&(b='<a target="_blank" href="'+a.viewData.link+'" title="'+a.viewData.name+'">'+a.name_trans+"</a>"),f=W.is("performance")&&d&&b?"%":"",i.push("<td "+(W.is("performance")&&d?g(b):h(c,a))+' data-column-name="'+c+'">'+(b||" - ")+f+"</td>")}),W.is("overview")&&i.push("<td></td>"),i.push("</tr>")}),e(c),S.html(i.join(""))}function g(a){var b=+a;return'class="symbol bold elp '+(b>0?"green":b<0?"red":"black")+'Font"'}function h(a,b,c){var d,e="";return a.is("name_trans")&&(e="symbol left bold elp "),V.indexOf(a)>-1&&(e+=" left "),W.is("technical")&&a.isnt("name_trans")&&(d=b[a+"_Color"],e+=void 0!==d&&d.is("black")?"analysisNeutral":d+"Font"),c?e:e?'class="'+e+'"':""}function i(a){U.html(a)._show(),_=!0}function j(){var a=k(),b=a.toHash();Z[b]?i(Z[b]):(ba=!0,$.ajax({url:"/stockscreener/service/CSP",type:"POST",data:{pairs_list:a},success:function(a){ba=!1,Z[b]=a,i(a)}}))}function k(){return y.hits.map(function(a){return a.pair_ID}).join(",")}function l(){function a(b){var c=b.is("csp");ba||(y.hits?(W=b,T.find("li").removeClass("selected").filter(".js-tab-"+W).addClass("selected"),U._hide(),P._toggleShow(!c),c?(_?U._show():j(),window.getPairsInCSVFromLastResults=k):(f(W.is("overview")?O:X[W]),window.getPairsInCSVFromLastResults=null)):setTimeout(a.bind(null,b),100))}aa=a.bind(null,"overview"),T.find("li.js-tab-overview a").click(aa),T.find("li.js-tab-fundamental a").click(a.bind(null,"fundamental")),T.find("li.js-tab-technical a").click(a.bind(null,"technical")),T.find("li.js-tab-performance a").click(a.bind(null,"performance")),T.find("li.js-tab-csp a").click(a.bind(null,"csp"))}function m(){var a=$("#resultsTable th:visible").length;$("#resultsTable [colspan]").attr("colspan",a)}var n=1e3,o={},p=null,q=null,r=!1,s=null,t=null,u=null,v=null,w=null,x="",y={},z=!1,A=!1,B=function(a,b){var c=/{([\w]+)}/g;return a.replace(c,function(a,c){return b.hasOwnProperty(c)?b[c]:""})},C=function(a){return w.find("th[data-column-name='"+a+"']").hasClass("displayNone")},D=window.siteData&&window.siteData.decimalPoint?window.siteData.decimalPoint:".",E=window.siteData&&window.siteData.thousandSep?window.siteData.thousandSep:",",F=function(a){var b={T:1e12,B:1e9,M:1e6,K:1e3},c=0,d=a<0;a=Math.abs(a);for(var e in b)if(a>=b[e])return c=Number(a/b[e]),((d?"-":"")+c.toFixed(2)+e).replace(".",D);return c=Number(a),(d?"-":"")+c.toFixed(2).replace(".",D)},G=function(a){if("number"==typeof a||a.toString()===Number(a).toExponential())return Number(a);var b={T:1e12,B:1e9,M:1e6,K:1e3};a=a.toString().replace(new RegExp("\\"+E,"g"),"").replace(D,".").replace("%","");for(var c in b){var d=a.toUpperCase();if(-1!==d.indexOf(c))return Number(d.replace(c,"")*b[c])}return Number(a)},H=function(a){var b={flagName:a.viewData.flag,pairLink:a.viewData.link,pairName:a.name_trans,fullName:a.viewData.name,pairSymbol:a.viewData.symbol},c=$(x);w.find("th").each(function(){var d=this.getAttribute("data-column-name");if(void 0!==a[d]){switch(b[d]=A?a[d+"_eu"]:a[d],d){case"a52_week_high_diff":case"a52_week_low_diff":case"a52_week_high_diff_eu":case"a52_week_low_diff_eu":!1!==strpos(d,"a52_week_high")&&(a52_week_high=b.a52_week_high,"string"==typeof a52_week_high&&!1!==strpos(b.a52_week_high,",")&&(a52_week_high=parseFloat(b.a52_week_high.replace(".","").replace(",","."))),0==Math.abs(a52_week_high)&&(b[d]="-")),!1!==strpos(d,"a52_week_low")&&(a52_week_low=b.a52_week_low,"string"==typeof a52_week_low&&!1!==strpos(b.a52_week_low,",")&&(a52_week_low=parseFloat(b.a52_week_low.replace(".","").replace(",","."))),0==Math.abs(a52_week_low)&&(b[d]="-"))}if(A)switch(d){case"exchange_trans":b[d]=a.exchange_trans;break;case"sector_trans":b[d]=a.sector_trans;break;case"industry_trans":b[d]=a.industry_trans;break;case"tech_sum_900":case"tech_sum_3600":case"tech_sum_86400":case"tech_sum_week":case"tech_sum_month":b[d]=a[d+"_constant"],c.find("[data-column-name='"+d+"']").removeClass("redFont greenFont analysisNeutral").addClass(h(d,a,!0))}else switch(d){case"a52_week_high_diff":case"a52_week_low_diff":case"a52_week_high_diff_eu":case"a52_week_low_diff_eu":if("-"==b[d])break;b[d]=F(a[d]);break;case"last":case"a52_week_high":case"a52_week_low":case"name_trans":case"viewData.symbol":break;case"tech_sum_900":case"tech_sum_3600":case"tech_sum_86400":case"tech_sum_week":case"tech_sum_month":b[d]=a[d+"_constant"],c.find("[data-column-name='"+d+"']").removeClass("redFont greenFont analysisNeutral").addClass(h(d,a,!0));break;case"month_change":case"yield_us":case"pair_change_percent":b[d]=b[d]+"%";break;case"exchange_trans":b[d]=a.exchange_trans;break;case"sector_trans":b[d]=a.sector_trans;break;case"industry_trans":b[d]=a.industry_trans;break;default:b[d]=F(a[d])}}else b[d]="-";C(d)?c.find("[data-column-name='"+d+"']").addClass("displayNone"):c.find("[data-column-name='"+d+"']").removeClass("displayNone")}),C("pairName")&&c.find("[data-column-name='name_trans']").addClass("displayNone"),C("pairSymbol")&&c.find("[data-column-name='viewData.symbol']").addClass("displayNone");var d=c[0].outerHTML;return B(d,b)},I=function(a){v.empty();for(var b in a)v.append(H(a[b]))},J=function(a){if($("div[widget-addtoportfolio='']")){var b=[];for(var c in a)b.push(a[c].pair_ID);$("div[attr-addtoportfoliopop='']").attr("pair_IDS",b)}},K=function(a){$("#paginationWrap").remove(),p.append(a)},L=function(){var a=$(".js-stock-screener-results"),b=$(".s-stock-screener-loader"),c=$("#resultsTable"),d=q;b.addClass("displayNone"),c.find(">tbody").empty(),c.find("tbody").append(d),a.add(c).add(d).removeClass("displayNone"),s.html("0"),FiltersHeap.setPageNum(1)},M=function(b){if(void 0!==b.totalCount&&s.html(b.totalCount),void 0!==b.paginationHTML&&(FiltersHeap.setPageNum(b.pageNumber),K(b.paginationHTML)),void 0!==b.hits){if(b.hits.length<1)return L();A=void 0!==b.isEU&&b.isEU,a()||(I(b.hits),J(b.hits))}else L()},N=function(a){if(!z){if(!r)throw new Error("Search disabled, not yet initialized.");var c=FiltersHeap.getFilterData();(a||!1)&&(c.cache=!0),c.pn=FiltersHeap.getPageNum();var d=FiltersHeap.getOrder();0!==$.trim(d.col).length&&(c.order=d);var e=$(".js-stock-screener-results"),f=$(".s-stock-screener-loader"),g=$("#resultsTable"),h=q;f.removeClass("displayNone"),e.add(g).removeClass("displayNone"),g.addClass("searchBlur"),g.data("alreadySearched")||(h.addClass("displayNone"),g.data("alreadySearched",!0)),$("#paginationWrap").remove(),b(c),ba=!0,$.ajax({url:"/stock-screener/Service/SearchStocks",type:"POST",dataType:"json",data:c,success:function(a){if(_=!1,h.addClass("displayNone"),$(".s-stock-screener-loader").addClass("displayNone"),g.removeClass("searchBlur"),ba=!1,a){if(a.error)throw new Error(a.error);a.hits.length&&L(),y=a,M(a),m();for(var b in o)o[b](a)}}})}},O=d(),P=$("#resultsContainer"),Q=P.find("#resultsTable"),R=Q.find("thead"),S=Q.find("tbody"),T=$("#stockScreenerResultsTabs"),U=$(".js-ss-csp-wrapper"),V=["viewData.symbol","exchange_trans","sector_trans","industry_trans","tech_sum_900","tech_sum_3600","tech_sum_86400","tech_sum_week","tech_sum_month"],W="js-tab-overview",X={fundamental:["name_trans","eq_market_cap","eq_pe_ratio","eq_revenue","avg_volume","eq_eps","eq_beta","eq_dividend","yield_us"],technical:["name_trans","tech_sum_900","tech_sum_3600","tech_sum_86400","tech_sum_week","tech_sum_month"],performance:["name_trans","daily","week","month","ytd","year","3year"],csp:[]},Y={fundamental:siteData.isEu?"_eu":"_frmt",technical:"_constant",performance:siteData.isEu?"_eu":""},Z={},_=!1;l(),window.stockScreenerColumnsApply=function(){O=this.getSelectedColumns().filter(function(a){return a.isnt("tableAdjust")}),f(O),columnsSettings_stock_screener.showHideColumns({ajaxUrl:"/members-admin/service/UpdateCustomSettings"})};var aa,ba=!1;$("#selectColumnsButton_stock_screener").click(function(a){setTimeout(FilterStocks.setColspanOfResultsTable,100)}),$(".js-download-stockscreener-data").click(function(){var a="overview",b=$("#stockScreenerResultsTabs li").filter(".selected").attr("class");b.search("js-tab-overview")>-1?a="overview":b.search("js-tab-fundamental")>-1?a="fundamental":b.search("js-tab-performance")>-1?a="performance":b.search("js-tab-technical")>-1?a="technical":b.search("js-tab-csp")>-1&&(a="csp"),c(a)});var ca=function(a,b){o[a]=b},da=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},ea=da(function(a){N(a)},n),fa=function(){s=$(".js-total-results"),t=$(".js-stock-screener-results"),u=$(".js-stock-screener-loader"),p=$("#resultsContainer"),q=$(".js-no-results"),r=!0,w=$("#resultsTable thead"),v=$("#resultsTable tbody"),a()||(x=v.find("tr:first"),v.empty())};return $(".js-stockscreener-hp").on("click",function(a){window.siteData&&6==+window.siteData.domainID?window.open("/stock-screener/?sp="+FiltersHeap.serialize(),"_blank"):location.href="/stock-screener/?sp="+FiltersHeap.serialize()}),{init:fa,search:ea,getSearchResults:y,registerSearchCallback:ca,disableSearch:function(){z=!0},enableSearch:function(){z=!1},isDisabled:function(){return z},numberToFormatted:function(a){return F(a)},formattedToNumber:function(a){return G(a)},isHomePage:a,setColspanOfResultsTable:m,lockTabs:function(a){ba=!!a},showSearchOverlay:function(){var a=$(".js-stock-screener-results"),b=$(".s-stock-screener-loader"),c=$("#resultsTable");b.removeClass("displayNone"),a.add(c).removeClass("displayNone"),c.addClass("searchBlur"),W.is("csp")&&aa()}}}();
// File: PrimaryFilters.js
var PrimaryFilters=function(){var a=$(".js-primary-filter-input"),b=$(".js-filter-dropdown"),c={},d={},e=function(a,b,c,e,f){var g=document.createElement("li");if(g.setAttribute("data-value",a),g.innerHTML=b,g.innerHTML+=f?" ("+f+")":"",e.appendChild(g),c){var h=e.parentNode.getAttribute("data-filter-type");d[h].selectByValue(a)}},f=function(a){var b=null;for("-1"===a.children[0].getAttribute("data-value")&&(b=a.children[0].cloneNode(!0));a.firstChild;)a.removeChild(a.firstChild);null!==b&&a.appendChild(b)},g=function(a){var b=/[\s]*\([\d]+\)/;return a.replace(b,"")},h=function(a){if(0!==a.hits.length||FilterStocks.isHomePage()){var c={exchange:a.aggs.exchangeAgg.buckets,sector:a.aggs.sectorAgg.buckets,industry:a.aggs.indAgg.buckets,equityType:a.aggs.equityAgg.buckets};b.each(function(){var a=this.getAttribute("data-filter-type");if(!c.hasOwnProperty(a))return!0;$(this).find("li").each(function(){if(this.innerHTML=g(this.innerHTML),0===c[a].length)return!0;for(var b in c[a])c[a][b].key==this.getAttribute("data-value").toLowerCase()&&(this.innerHTML+=' <span dir="ltr">('+c[a][b].doc_count+")</span>")}),$(this).find("input").each(function(){this.getAttribute("data-value");this.value=g(this.value)})})}},i=function(a){var b=a.find("li").length,c=b>2,d=$("#colSelectPopup_stock_screener").find("input[data-column-name='exchange_trans']"),e=d.prop("checked"),f=d.prop("disabled");!c||e||f||(d.click(),d.prop("checked",!0),$("#selectColumnsButton_stock_screener").click())},j=function(a){if(void 0!==a.exchanges){var b=$("#exchange").find(".js-dropdown"),g=$("#exchange").find(".js-search-input")[0];f(b[0]);for(var j in a.exchanges){var k=a.exchanges[j],l=null;FilterStocks.isHomePage()&&(l=a.aggs.exchangeAgg.buckets[j].doc_count),e(k,c[k],!1,b[0],l)}var m=b.find("li:first-child");g.value=m.text(),g.setAttribute("data-value",m.attr("data-value")),d.exchange.refresh(),i(b)}h(a)},k=function(a,b,c){var e=$(a),f=e.find("li[data-value="+b+"]")[0];if(void 0===f&&(f=e.find("li:first-child")[0],FiltersHeap.addFilterValue(c,f.getAttribute("data-value"))),null!==f){var g=f.getAttribute("data-value");d[c].selectByValue(g)}};return this.buildSelection=function(){b.each(function(){var a=this.getAttribute("data-filter-type");k(this,FiltersHeap.getFilterValue(a),a)})},this.getAllPrimaryFiltersLables=function(){c=window.exchangesLables,delete window.exchangesLables},this.registerEvents=function(){if(a.length<1)throw new Error("no primary filters found");FilterStocks.registerSearchCallback("primaryFilters",j),b.each(function(){var a=$(this),b=a.attr("data-filter-type"),c=a.find("input.js-search-input"),e=a.find("#countryFlag");d[b]=new DropdownSelector(this,c,null,!0,c.attr("placeholder")),a.on("dropDownSelected",function(b,c,d,f){var h=a.find("input"),i=h.attr("value");h.attr("value",g(i));var j=a[0].getAttribute("data-filter-type");if(null!==f&&"country"===j){var k=f.dataset.flagValue;e.attr("class",k)}FiltersHeap.addFilterValue(j,d),"country"===j&&$(window).trigger(PrimaryFilters.COUNTRY_CHANGE_EVENT,[d]),FilterStocks.showSearchOverlay(),FilterStocks.search()})})},$(document).on("blur",".js-primary-filters .js-search-input",function(){for(var a=0;a<2;a++)setTimeout(function(a){a.value=g(a.value)},100*(a+1),this)}),this};PrimaryFilters.COUNTRY_CHANGE_EVENT="stockScreenerPrimaryFilterCountryChanged";
// File: nouislider.js
!function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.noUiSlider=a()}(function(){"use strict";function a(a){return a.filter(function(a){return!this[a]&&(this[a]=!0)},{})}function b(a,b){return Math.round(a/b)*b}function c(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.documentElement,e=m();return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(e.x=0),{top:b.top+e.y-d.clientTop,left:b.left+e.x-d.clientLeft}}function d(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)}function e(a){if(a.toExponential()===a.toString())return a;var b=Math.pow(10,7);return Number((Math.round(a*b)/b).toFixed(7))}function f(a,b,c){j(a,b),setTimeout(function(){k(a,b)},c)}function g(a){return Math.max(Math.min(a,100),0)}function h(a){return Array.isArray(a)?a:[a]}function i(a){var b=a.split(".");return b.length>1?b[1].length:0}function j(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function k(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function l(a,b){a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function m(){var a=void 0!==window.pageXOffset,b="CSS1Compat"===(document.compatMode||"");return{x:a?window.pageXOffset:b?document.documentElement.scrollLeft:document.body.scrollLeft,y:a?window.pageYOffset:b?document.documentElement.scrollTop:document.body.scrollTop}}function n(a){a.stopPropagation()}function o(a){return function(b){return a+b}}function p(a,b){return 100/(b-a)}function q(a,b){return 100*b/(a[1]-a[0])}function r(a,b){return q(a,a[0]<0?b+Math.abs(a[0]):b-a[0])}function s(a,b){return b*(a[1]-a[0])/100+a[0]}function t(a,b){for(var c=1;a>=b[c];)c+=1;return c}function u(a,b,c){if(c>=a.slice(-1)[0])return 100;var d,e,f,g,h=t(c,a);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],f+r([d,e],c)/p(f,g)}function v(a,b,c){if(c>=100)return a.slice(-1)[0];var d,e,f,g,h=t(c,b);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],s([d,e],(c-f)*p(f,g))}function w(a,c,d,e){if(100===e)return e;var f,g,h=t(e,a);return d?(f=a[h-1],g=a[h],e-f>(g-f)/2?g:f):c[h-1]?a[h-1]+b(e-a[h-1],c[h-1]):e}function x(a,b,c){var e;if("number"==typeof b&&(b=[b]),"[object Array]"!==Object.prototype.toString.call(b))throw new Error("noUiSlider: 'range' contains invalid value.");if(e="min"===a?0:"max"===a?100:parseFloat(a),!d(e)||!d(b[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");c.xPct.push(e),c.xVal.push(b[0]),e?c.xSteps.push(!isNaN(b[1])&&b[1]):isNaN(b[1])||(c.xSteps[0]=b[1])}function y(a,b,c){if(!b)return!0;c.xSteps[a]=q([c.xVal[a],c.xVal[a+1]],b)/p(c.xPct[a],c.xPct[a+1])}function z(a,b,c,d){this.xPct=[],this.xVal=[],this.xSteps=[d||!1],this.xNumSteps=[!1],this.snap=b,this.direction=c;var e,f=[];for(e in a)a.hasOwnProperty(e)&&f.push([a[e],e]);for(f.length&&"object"==typeof f[0][0]?f.sort(function(a,b){return void 0!==a[0][1]&&void 0!==b[0][1]?a[0][1]-b[0][1]:a[0][0]-b[0][0]}):f.sort(function(a,b){return a[0]-b[0]}),e=0;e<f.length;e++)x(f[e][1],f[e][0],this);for(this.xNumSteps=this.xSteps.slice(0),e=0;e<this.xNumSteps.length;e++)y(e,this.xNumSteps[e],this)}function A(a,b){if(!d(b))throw new Error("noUiSlider: 'step' is not numeric.");a.singleStep=b}function B(a,b){if("object"!=typeof b||Array.isArray(b))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===b.min||void 0===b.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");if(b.min===b.max)throw new Error("noUiSlider: 'range' 'min' and 'max' cannot be equal.");a.spectrum=new z(b,a.snap,a.dir,a.singleStep)}function C(a,b){if(b=h(b),!Array.isArray(b)||!b.length||b.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");a.handles=b.length,a.start=b}function D(a,b){if(a.snap=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function E(a,b){if(a.animate=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function F(a,b){if("lower"===b&&1===a.handles)a.connect=1;else if("upper"===b&&1===a.handles)a.connect=2;else if(!0===b&&2===a.handles)a.connect=3;else{if(!1!==b)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");a.connect=0}}function G(a,b){switch(b){case"horizontal":a.ort=0;break;case"vertical":a.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function H(a,b){if(!d(b))throw new Error("noUiSlider: 'margin' option must be numeric.");if(a.margin=a.spectrum.getMargin(b),!a.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function I(a,b){if(!d(b))throw new Error("noUiSlider: 'limit' option must be numeric.");if(a.limit=a.spectrum.getMargin(b),!a.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function J(a,b){switch(b){case"ltr":a.dir=0;break;case"rtl":a.dir=1,a.connect=[0,2,1,3][a.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function K(a,b){if("string"!=typeof b)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var c=b.indexOf("tap")>=0,d=b.indexOf("drag")>=0,e=b.indexOf("fixed")>=0,f=b.indexOf("snap")>=0,g=b.indexOf("hover")>=0;if(d&&!a.connect)throw new Error("noUiSlider: 'drag' behaviour must be used with 'connect': true.");a.events={tap:c||f,drag:d,fixed:e,snap:f,hover:g}}function L(a,b){var c;if(!1!==b)if(!0===b)for(a.tooltips=[],c=0;c<a.handles;c++)a.tooltips.push(!0);else{if(a.tooltips=h(b),a.tooltips.length!==a.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");a.tooltips.forEach(function(a){if("boolean"!=typeof a&&("object"!=typeof a||"function"!=typeof a.to))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")})}}function M(a,b){if(a.format=b,"function"==typeof b.to&&"function"==typeof b.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function N(a,b){if(void 0!==b&&"string"!=typeof b)throw new Error("noUiSlider: 'cssPrefix' must be a string.");a.cssPrefix=b}function O(a){var b,c={margin:0,limit:0,animate:!0,format:T};b={step:{r:!1,t:A},start:{r:!0,t:C},connect:{r:!0,t:F},direction:{r:!0,t:J},snap:{r:!1,t:D},animate:{r:!1,t:E},range:{r:!0,t:B},orientation:{r:!1,t:G},margin:{r:!1,t:H},limit:{r:!1,t:I},behaviour:{r:!0,t:K},format:{r:!1,t:M},tooltips:{r:!1,t:L},cssPrefix:{r:!1,t:N}};var d={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"};return Object.keys(b).forEach(function(e){if(void 0===a[e]&&void 0===d[e]){if(b[e].r)throw new Error("noUiSlider: '"+e+"' is required.");return!0}b[e].t(c,void 0===a[e]?d[e]:a[e])}),c.pips=a.pips,c.style=c.ort?"top":"left",c}function P(b,d){function e(a,b,c){var d=a+b[0],e=a+b[1];return c?(d<0&&(e+=Math.abs(d)),e>100&&(d-=e-100),[g(d),g(e)]):[d,e]}function p(a,b){a.preventDefault();var c,d,e=0===a.type.indexOf("touch"),f=0===a.type.indexOf("mouse"),g=0===a.type.indexOf("pointer"),h=a;return 0===a.type.indexOf("MSPointer")&&(g=!0),e&&(c=a.changedTouches[0].pageX,d=a.changedTouches[0].pageY),b=b||m(),(f||g)&&(c=a.clientX+b.x,d=a.clientY+b.y),h.pageOffset=b,h.points=[c,d],h.cursor=f||g,h}function q(a,b){var c=document.createElement("div"),d=document.createElement("div"),e=["-lower","-upper"];return a&&e.reverse(),j(d,da[3]),j(d,da[3]+e[b]),j(c,da[2]),c.appendChild(d),c}function r(a,b,c){switch(a){case 1:j(b,da[7]),j(c[0],da[6]);break;case 3:j(c[1],da[6]);case 2:j(c[0],da[7]);case 0:j(b,da[6])}}function s(a,b,c){var d,e=[];for(d=0;d<a;d+=1)e.push(c.appendChild(q(b,d)));return e}function t(a,b,c){j(c,da[0]),j(c,da[8+a]),j(c,da[4+b]);var d=document.createElement("div");return j(d,da[1]),c.appendChild(d),d}function u(a,b){if(!d.tooltips[b])return!1;var c=document.createElement("div");return c.className=da[18],a.firstChild.appendChild(c)}function v(){d.dir&&d.tooltips.reverse();var a=Y.map(u);d.dir&&(a.reverse(),d.tooltips.reverse()),U("update",function(b,c,e){a[c]&&(a[c].innerHTML=!0===d.tooltips[c]?b[c]:d.tooltips[c].to(e[c]))})}function w(a,b,c){if("range"===a||"steps"===a)return aa.xVal;if("count"===a){var d,e=100/(b-1),f=0;for(b=[];(d=f++*e)<=100;)b.push(d);a="positions"}return"positions"===a?b.map(function(a){return aa.fromStepping(c?aa.getStep(a):a)}):"values"===a?c?b.map(function(a){return aa.fromStepping(aa.getStep(aa.toStepping(a)))}):b:void 0}function x(b,c,d){function e(a,b){return(a+b).toFixed(7)/1}var f=aa.direction,g={},h=aa.xVal[0],i=aa.xVal[aa.xVal.length-1],j=!1,k=!1,l=0;return aa.direction=0,d=a(d.slice().sort(function(a,b){return a-b})),d[0]!==h&&(d.unshift(h),j=!0),d[d.length-1]!==i&&(d.push(i),k=!0),d.forEach(function(a,f){var h,i,m,n,o,p,q,r,s,t,u=a,v=d[f+1];if("steps"===c&&(h=aa.xNumSteps[f]),h||(h=v-u),!1!==u&&void 0!==v)for(i=u;i<=v;i=e(i,h)){for(n=aa.toStepping(i),o=n-l,r=o/b,s=Math.round(r),t=o/s,m=1;m<=s;m+=1)p=l+m*t,g[p.toFixed(5)]=["x",0];q=d.indexOf(i)>-1?1:"steps"===c?2:0,!f&&j&&(q=0),i===v&&k||(g[n.toFixed(5)]=[i,q]),l=n}}),aa.direction=f,g}function y(a,b,c){function e(a){return["-normal","-large","-sub"][a]}function f(a,b,c){return'class="'+b+" "+b+"-"+h+" "+b+e(c[1])+'" style="'+d.style+": "+a+'%"'}function g(a,d){aa.direction&&(a=100-a),d[1]=d[1]&&b?b(d[0],d[1]):d[1],i.innerHTML+="<div "+f(a,da[21],d)+"></div>",d[1]&&(i.innerHTML+="<div "+f(a,da[22],d)+">"+c.to(d[0])+"</div>")}var h=["horizontal","vertical"][d.ort],i=document.createElement("div");return j(i,da[20]),j(i,da[20]+"-"+h),Object.keys(a).forEach(function(b){g(b,a[b])}),i}function z(a){var b=a.mode,c=a.density||1,d=a.filter||!1,e=a.values||!1,f=a.stepped||!1,g=w(b,e,f),h=x(c,b,g),i=a.format||{to:Math.round};return $.appendChild(y(h,d,i))}function A(){return X["offset"+["Width","Height"][d.ort]]}function B(a,b,c){void 0!==b&&1!==d.handles&&(b=Math.abs(b-d.dir)),Object.keys(ca).forEach(function(d){var e=d.split(".")[0];a===e&&ca[d].forEach(function(a){a.call(Z,h(P()),b,h(C(Array.prototype.slice.call(ba))),c||!1)})})}function C(a){return 1===a.length?a[0]:d.dir?a.reverse():a}function D(a,b,c,e){var f=function(b){return!$.hasAttribute("disabled")&&(!l($,da[14])&&(b=p(b,e.pageOffset),!(a===R.start&&void 0!==b.buttons&&b.buttons>1)&&((!e.hover||!b.buttons)&&(b.calcPoint=b.points[d.ort],void c(b,e)))))},g=[];return a.split(" ").forEach(function(a){b.addEventListener(a,f,!1),g.push([a,f])}),g}function E(a,b){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===a.buttons&&0!==b.buttonsProperty)return F(a,b);var c,d,f=b.handles||Y,g=!1,h=100*(a.calcPoint-b.start)/b.baseSize,i=f[0]===Y[0]?0:1;if(c=e(h,b.positions,f.length>1),g=L(f[0],c[i],1===f.length),f.length>1){if(g=L(f[1],c[i?0:1],!1)||g)for(d=0;d<b.handles.length;d++)B("slide",d)}else g&&B("slide",i)}function F(a,b){var c=X.querySelector("."+da[15]),d=b.handles[0]===Y[0]?0:1;null!==c&&k(c,da[15]),a.cursor&&(document.body.style.cursor="",document.body.removeEventListener("selectstart",document.body.noUiListener));var e=document.documentElement;e.noUiListeners.forEach(function(a){e.removeEventListener(a[0],a[1])}),k($,da[12]),B("set",d),B("change",d),void 0!==b.handleNumber&&B("end",b.handleNumber)}function G(a,b){"mouseout"===a.type&&"HTML"===a.target.nodeName&&null===a.relatedTarget&&F(a,b)}function H(a,b){var c=document.documentElement;if(1===b.handles.length&&(j(b.handles[0].children[0],da[15]),b.handles[0].hasAttribute("disabled")))return!1;a.preventDefault(),a.stopPropagation();var d=D(R.move,c,E,{start:a.calcPoint,baseSize:A(),pageOffset:a.pageOffset,handles:b.handles,handleNumber:b.handleNumber,buttonsProperty:a.buttons,positions:[_[0],_[Y.length-1]]}),e=D(R.end,c,F,{handles:b.handles,handleNumber:b.handleNumber}),f=D("mouseout",c,G,{handles:b.handles,handleNumber:b.handleNumber});if(c.noUiListeners=d.concat(e,f),a.cursor){document.body.style.cursor=getComputedStyle(a.target).cursor,Y.length>1&&j($,da[12]);var g=function(){return!1};document.body.noUiListener=g,document.body.addEventListener("selectstart",g,!1)}void 0!==b.handleNumber&&B("start",b.handleNumber)}function I(a){var b,e,g=a.calcPoint,h=0;if(a.stopPropagation(),Y.forEach(function(a){h+=c(a)[d.style]}),b=g<h/2||1===Y.length?0:1,g-=c(X)[d.style],e=100*g/A(),d.events.snap||f($,da[14],300),Y[b].hasAttribute("disabled"))return!1;L(Y[b],e),B("slide",b,!0),B("set",b,!0),B("change",b,!0),d.events.snap&&H(a,{handles:[Y[b]]})}function J(a){var b=a.calcPoint-c(X)[d.style],e=aa.getStep(100*b/A()),f=aa.fromStepping(e);Object.keys(ca).forEach(function(a){"hover"===a.split(".")[0]&&ca[a].forEach(function(a){a.call(Z,f)})})}function K(a){var b,c;if(!a.fixed)for(b=0;b<Y.length;b+=1)D(R.start,Y[b].children[0],H,{handles:[Y[b]],handleNumber:b});if(a.tap&&D(R.start,X,I,{handles:Y}),a.hover)for(D(R.move,X,J,{hover:!0}),b=0;b<Y.length;b+=1)["mousemove MSPointerMove pointermove"].forEach(function(a){Y[b].children[0].addEventListener(a,n,!1)});a.drag&&(c=[X.querySelector("."+da[7])],j(c[0],da[10]),a.fixed&&c.push(Y[c[0]===Y[0]?1:0].children[0]),c.forEach(function(a){D(R.start,a,H,{handles:Y})}))}function L(a,b,c){var e=a!==Y[0]?1:0,f=_[0]+d.margin,h=_[1]-d.margin,i=_[0]+d.limit,l=_[1]-d.limit;return Y.length>1&&(b=e?Math.max(b,f):Math.min(b,h)),!1!==c&&d.limit&&Y.length>1&&(b=e?Math.min(b,i):Math.max(b,l)),b=aa.getStep(b),(b=g(parseFloat(b.toFixed(7))))!==_[e]&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){a.style[d.style]=b+"%"}):a.style[d.style]=b+"%",a.previousSibling||(k(a,da[17]),b>50&&j(a,da[17])),_[e]=b,ba[e]=aa.fromStepping(b),B("update",e),!0)}function M(a,b){var c,e,f;for(d.limit&&(a+=1),c=0;c<a;c+=1)e=c%2,null!==(f=b[e])&&!1!==f&&("number"==typeof f&&(f=String(f)),(!1===(f=d.format.from(f))||isNaN(f)||!1===L(Y[e],aa.toStepping(f),c===3-d.dir))&&B("update",e))}function N(a){var b,c,e=h(a);for(d.dir&&d.handles>1&&e.reverse(),d.animate&&-1!==_[0]&&f($,da[14],300),b=Y.length>1?2:1,1===e.length&&(b=1),M(b,e),c=0;c<Y.length;c++)B("set",c)}function P(){var a,b=[];for(a=0;a<d.handles;a+=1)b[a]=d.format.to(ba[a]);return C(b)}function Q(){da.forEach(function(a){a&&k($,a)}),$.innerHTML="",delete $.noUiSlider}function T(){return C(_.map(function(a,b){var c=aa.getApplicableStep(a),d=i(String(c[2])),e=ba[b],f=100===a?null:c[2],g=Number((e-c[2]).toFixed(d));return[0===a?null:g>=c[1]?c[2]:c[0]||!1,f]}))}function U(a,b){ca[a]=ca[a]||[],ca[a].push(b),"update"===a.split(".")[0]&&Y.forEach(function(a,b){B("update",b)})}function V(a){var b=a.split(".")[0],c=a.substring(b.length);Object.keys(ca).forEach(function(a){var d=a.split(".")[0],e=a.substring(d.length);b&&b!==d||c&&c!==e||delete ca[a]})}function W(a){var b,c=P(),e=O({start:[0,0],margin:a.margin,limit:a.limit,step:a.step,range:a.range,animate:a.animate,snap:void 0===a.snap?d.snap:a.snap});for(["margin","limit","step","range","animate"].forEach(function(b){void 0!==a[b]&&(d[b]=a[b])}),aa=e.spectrum,_=[-1,-1],N(c),b=0;b<Y.length;b++)B("update",b)}var X,Y,Z,$=b,_=[-1,-1],aa=d.spectrum,ba=[],ca={},da=["target","base","origin","handle","horizontal","vertical","background","connect","ltr","rtl","draggable","","state-drag","","state-tap","active","","stacking","tooltip","","pips","marker","value"].map(o(d.cssPrefix||S));if($.noUiSlider)throw new Error("Slider was already initialized.");return X=t(d.dir,d.ort,$),Y=s(d.handles,d.dir,X),r(d.connect,$,Y),d.pips&&z(d.pips),d.tooltips&&v(),Z={destroy:Q,steps:T,on:U,off:V,get:P,set:N,updateOptions:W},K(d.events),Z}function Q(a,b){if(!a.nodeName)throw new Error("noUiSlider.create requires a single element.");var c=O(b,a),d=P(a,c);return d.set(c.start),a.noUiSlider=d,d}var R=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},S="noUi-";z.prototype.getMargin=function(a){return 2===this.xPct.length&&q(this.xVal,a)},z.prototype.toStepping=function(a){return a=u(this.xVal,this.xPct,a),this.direction&&(a=100-a),a},z.prototype.fromStepping=function(a){return this.direction&&(a=100-a),e(v(this.xVal,this.xPct,a))},z.prototype.getStep=function(a){return this.direction&&(a=100-a),a=w(this.xPct,this.xSteps,this.snap,a),this.direction&&(a=100-a),a},z.prototype.getApplicableStep=function(a){var b=t(a,this.xPct),c=100===a?2:1;return[this.xNumSteps[b-2],this.xVal[b-c],this.xNumSteps[b-c]]},z.prototype.convert=function(a){return this.getStep(this.toStepping(a))};var T={to:function(a){return void 0!==a&&a.toFixed(2)},from:Number};return{create:Q}});
// File: SecondaryFilters.js
var SecondaryFilters=function(a){var b={},c={},d="",e=a||{},f=null,g=null,h=null,i=null,j=[],k="noData",l=5,m=!1,n=function(){for(var a in c)c[a].filter.removeFilter(),q(a);c={}},o=function(){var a=FiltersHeap.getFilterValue("country");a!==l&&n(),l=a},p=function(a){-1===j.indexOf(a)&&i.find("input[data-column-name='"+a+"']").parent().removeClass("displayNone")},q=function(a){if(-1===j.indexOf(a)){var b=i.find("input[data-column-name='"+a+"']");b.prop("checked")||b.parent().addClass("displayNone")}},r=function(a,b){if("function"!=typeof b&&(b=function(a){}),o(),"object"==typeof c[a])return c[a].filter.reset(),f.append(c[a].filter.getContent()),c[a].enabled=!0,h.removeClass(k),p(a),b(c[a].filter);m=!0,FilterStocks.lockTabs(!0),$.ajax({url:"/stock-screener/Service/SecondaryFiltersRange",type:"POST",data:{col:a,country:l},dataType:"json",error:function(a,b,c){throw c},success:function(d){if(FilterStocks.lockTabs(!1),m=!1,"object"!=typeof d)throw new Error("Invalid json return from server");if($.isEmptyObject(d))throw new Error("Empty json return from server");if(void 0!==d.error)throw new Error(d.error);if("number"!=typeof d.min)throw new Error("Secondary filter min value NaN/missing");if("number"!=typeof d.max)throw new Error("Secondary filter max value NaN/missing");var g=new RangeFilter(a,d.title,d.min,d.max,d.histogram,e);c[a]={filter:g,enabled:!0},f.append(g.getContent()),h.removeClass(k),b(g),p(a)}})},s=function(a,b){if("function"!=typeof b&&(b=function(a){}),!a.length||0===a.length)return void b({});o();for(var d in a)"object"!=typeof c[a[d]]||(c[a[d]].filter.reset(),f.append(c[a[d]].filter.getContent()),c[a[d]].enabled=!0,h.removeClass(k),p(a[d]));m=!0,FilterStocks.lockTabs(!0),$.ajax({url:"/stock-screener/Service/MultipleSecondaryFiltersRange",type:"POST",data:{cols:a,country:l},dataType:"json",error:function(a,b,c){throw c},success:function(a){FilterStocks.lockTabs(!1),m=!1;var d={};for(var i in a){if("object"!=typeof a)throw new Error("Invalid json return from server");if($.isEmptyObject(a))throw new Error("Empty json return from server");if(void 0!==a.error)throw new Error(a.error);if("number"!=typeof a[i].min)throw new Error("Secondary filter "+i+" min value NaN/missing");if("number"!=typeof a[i].max)throw new Error("Secondary filter "+i+" max value NaN/missing");var j=new RangeFilter(i,a[i].title,a[i].min,a[i].max,a[i].histogram,e);c[i]={filter:j,enabled:!0},d[i]=j,g.find(".js-filter-choice[data-id="+i+"]").addClass("selected"),f.append(j.getContent()),h.removeClass(k),p(i)}b(d)}})},t=function(a){FilterStocks.showSearchOverlay();var e=$(this),f=this.getAttribute("data-id");if(o(),e.hasClass("selected"))return void 0===c[f]?!m&&e.removeClass("selected"):c[f].filter.removeFilter();e.addClass("selected"),b[d]=$("#directoryFilter").html(),r(f,null)},u=function(a){a.find(".js-filter-choice").click(t)},v=function(a){a.find(".selected").removeClass("selected"),f.find(".rangeWrapper").each(function(){var b=this.id;a.find("[data-id="+b+"]").addClass("selected")})},w=function(a,c,e,f){if(d=e,void 0!==b[d])return g.html(b[d]),v(g),u(g);$.ajax({url:"/stock-screener/Service/SecondaryFilters",type:"POST",data:{cat:d},dataType:"html",success:function(a){0===a.length&&new Error("unexcpected empty response given"),b[d]=a,g.html(a),v(g),u(g)}})},x=function(a,b){$(".js-filter-choice").each(function(){this.getAttribute("data-id")===b&&$(this).removeClass("selected")}),""===$.trim(f.html())&&h.addClass(k),c[b].enabled=!1,q(b)};this.buildSelection=function(a){var b=FiltersHeap.getRangeFilters(),c=[];for(var d in b)c.push(d);if("function"!=typeof a&&(a=function(){}),0===c.length)return a();for(var e in c)g.find(".js-filter-choice[data-id="+c[e]+"]").addClass("selected");s(c,function(c){for(var d in b)c[d].setMinMax(FilterStocks.numberToFormatted(b[d].min),FilterStocks.numberToFormatted(b[d].max));a()})};var y=function(){FilterStocks.disableSearch();var a=[];for(var b in c)c[b].enabled&&a.push(b);o(),s(a,function(){FilterStocks.enableSearch(),FilterStocks.search()})};!function(){h=$("#secondaryFiltersCriterias"),f=h.find(".js-content"),g=$("#directoryFilter"),i=$("#colSelectPopup_stock_screener"),i.find("input[type=checkbox]").each(function(){$(this.parentNode).hasClass("displayNone")||j.push(this.getAttribute("data-column-name"))});var a=$(window);a.on("multiFilter-ChangeFilterTypeAction",w),a.on(RangeFilter.closeEventID,x),a.on(PrimaryFilters.COUNTRY_CHANGE_EVENT,y),u($("#directoryFilter"));var b=document.documentElement.getAttribute("dir");e.direction=null===b||""===b?"ltr":b}();return this},RangeFilter=function(a,b,c,d,e,f){var g=null,h=null,i=null,j=null,k=null,l={wrapper:"",title:"",min:"",max:"",range:"",close:"",direction:"ltr",histWrapper:{w:146,h:18,classes:"rangeChart"}},m=null,n=c,o=d,p=[8,13,16,17,18,20,35,36,37,38,39,40,45,46,97,100,102,109,110],q=[49,50,51,52,53,54,55,56,57,48,144,103,104,105,100,101,102,96,97,98,99],r=[".",",","-","k","K","M","m","B","b"],s=[188,189,190],t={min:n,max:o},u=function(a){if(0===a.length)return{min:c,max:d};for(var b=100/a.length,e=0,f={min:[a[0],0]},g=1;g<a.length-1;++g)e+=b,f[e+"%"]=[a[g],g];return f.max=[a[a.length-1],a.length-1],f},v=function(b){if(c!==d){var g=u(b);m.create(j,{start:[c,d],connect:!1,direction:f.direction,range:g,snap:!1,format:{to:function(a){return FilterStocks.numberToFormatted(a)},from:function(a){return FilterStocks.formattedToNumber(a)}}}),j.noUiSlider.on("slide",function(a,b){0===b?t.min=null:t.max=null}),j.noUiSlider.on("update",function(b,e){var f,g,j=b[e];switch(e){case 0:t.min&&(null===t.max||FilterStocks.formattedToNumber(t.max)>=FilterStocks.formattedToNumber(t.min))?(f=FilterStocks.formattedToNumber(t.min),g=FilterStocks.numberToFormatted(f)):(g=j,f=FilterStocks.formattedToNumber(j)),h.value=g,c=f;break;case 1:t.max&&(null===t.min||FilterStocks.formattedToNumber(t.max)>=FilterStocks.formattedToNumber(t.min))?(f=FilterStocks.formattedToNumber(t.max),g=FilterStocks.numberToFormatted(f),t.max=null):(g=j,f=FilterStocks.formattedToNumber(j)),i.value=g,d=f}FiltersHeap.addFilterRange(a,c,d),FilterStocks.isDisabled()||(FilterStocks.showSearchOverlay(),FilterStocks.search())}),$(h).on("change",function(){var a=FilterStocks.formattedToNumber(h.value);a>FilterStocks.formattedToNumber(i.value)&&(h.value=i.value),a<e.steps[0]&&(h.value=FilterStocks.numberToFormatted(c)),t.min=h.value,j.noUiSlider.set([h.value,null])}),$(i).on("change",function(){var a=FilterStocks.formattedToNumber(i.value);a<FilterStocks.formattedToNumber(h.value)&&(i.value=h.value),a>e.steps[e.steps.length-1]&&(i.value=FilterStocks.numberToFormatted(d)),t.max=i.value,j.noUiSlider.set([null,i.value])})}},w=function(){null!==g.parentNode&&(FilterStocks.showSearchOverlay(),FiltersHeap.removeFilter(a),g.parentNode.removeChild(g),$(window).trigger(RangeFilter.closeEventID,[a]),FilterStocks.search())},x=function(a,b){for(var c in b)if(b[c]===a)return!0;return!1},y=function(a){var b=a.value,c=window.siteData&&window.siteData.decimalPoint?window.siteData.decimalPoint:".",d=window.siteData&&window.siteData.thousandSep?window.siteData.thousandSep:",";$(a).on("keydown",function(e){var f=a.value.replace(/[kmb]/gi,"").replace(new RegExp("\\"+d,"g"),"");return("-"===f||isNumeric(f||0,c))&&(b=a.value),!!(x(e.keyCode,q)||x(e.keyCode,p)||x(e.key||String.fromCharCode(e.keyCode),r))||(!!x(e.keyCode,s)||(e.preventDefault(),!1))}).on("keyup",function(){var e=a.value.replace(/[kmb]/gi,"").replace(new RegExp("\\"+d,"g"),"");if("-"===e||isNumeric(e||0,c))return!0;a.value=b})},z=function(){var g=document.createElement("div");g.setAttribute("class",f.wrapper),g.setAttribute("id",a);var l=document.createElement("span");l.innerHTML=b,l.setAttribute("class",f.title),l.setAttribute("title",b);var m=document.createElement("div");return new RangeHistogram(m,f.histWrapper.h,f.histWrapper.w,f.histWrapper.classes,e.buckets).setHistogram(),j=document.createElement("div"),j.setAttribute("class",f.range),h=document.createElement("input"),h.setAttribute("type","text"),h.setAttribute("value",c),h.setAttribute("class",f.min),y(h),i=document.createElement("input"),i.setAttribute("type","text"),i.setAttribute("value",d),i.setAttribute("class",f.max),y(i),k=document.createElement("i"),k.setAttribute("class",f.close),k.innerHTML="",$(k).click(w),g.appendChild(l),g.appendChild(h),g.appendChild(j),g.appendChild(m),g.appendChild(i),g.appendChild(k),FiltersHeap.addFilterRange(a,c,d),v(e.steps),g};this.getContent=function(){return g},this.removeFilter=function(){w()},this.reset=function(){j.noUiSlider&&(c=n,d=o,t.min=c,t.max=d,j.noUiSlider.set([c,d]))},this.setMinMax=function(a,b){j.noUiSlider&&(t.min=a,t.max=b,j.noUiSlider.set([a,b]))};!function(){void 0!==window.noUiSlider&&(m=window.noUiSlider,f=$.extend(l,f),g=z())}()};RangeFilter.closeEventID="StockScreenerFilterRemoved";var RangeHistogram=function(a,b,c,d,e){var f={};this.setHistogram=function(){var b=$(a);b.addClass(d),b.highcharts(f)};var g=function(){return"rtl"===$("html").attr("dir")};!function(){g()&&e.reverse(),f={chart:{renderTo:"container",type:"column",inverted:!1,height:b,width:c,backgroundColor:"rgba(231,231,231,0.2)",margin:[0,0,0,0]},title:"",credits:{enabled:!1},xAxis:{lineWidth:0,gridLineWidth:0,minorGridLineWidth:0,lineColor:"transparent",title:{enabled:!1},labels:{enabled:!1},minorTickLength:0,tickLength:0},yAxis:{gridLineWidth:0,lineWidth:0,minorGridLineWidth:0,lineColor:"transparent",title:{enabled:!1},labels:{enabled:!1},minorTickLength:0,tickLength:0},tooltip:{enabled:!1},legend:{enabled:!1},series:[{name:"hst",pointPadding:1,groupPadding:1,borderWidth:0,data:e}]}}()};
// File: URLManipulator.js
var URLManipulator=function(){var a=!0,b=window,c="sp",d="",e="";this.updateURL=function(f){a&&!FilterStocks.isHomePage()&&b.history.replaceState("",e,d+"?"+c+"="+f)},this.clearURL=function(){a&&b.history.replaceState("",e,d)},this.getURLData=function(){var a=new String(b.location),d="?"+c+"=",e=a.indexOf(d);if(-1===e)return"";var f=a.substring(e+d.length);return window.decodeURIComponent(f)};var f=function(){var a=new String(b.location),c=a.indexOf("/",8),d=a.indexOf("?");return-1===c?"/":-1!==d?a.substring(c,d):a.substring(c)},g=function(){return document.getElementsByTagName("title").innerHTML};!function(){"object"!=typeof b.history?a=!1:"function"!=typeof b.history.pushState?a=!1:"function"!=typeof b.history.replaceState?a=!1:(d=f(),e=g())}()};
// File: columnSorter.js
var columnSorter=function(){var a="headerSortUp",b="headerSortDown",c="headerSortDefault",d=null,e=null,f={},g=function(){FilterStocks.showSearchOverlay();var a=this.getAttribute("data-column-name"),b=!f.hasOwnProperty(a),c=b?FiltersHeap.DESC_ORDER:f[a];if(!b)switch(c){case FiltersHeap.ASC_ORDER:c=FiltersHeap.DESC_ORDER;break;case FiltersHeap.DESC_ORDER:c=FiltersHeap.ASC_ORDER}h($(this).find("span"),c),f[a]=c,FiltersHeap.setOrder(a,c),FilterStocks.search()},h=function(e,f){d.find("."+a+",."+b).removeClass().addClass(c);var g=b;switch(f){case FiltersHeap.ASC_ORDER:g=a;break;case FiltersHeap.DESC_ORDER:g=b}e.removeClass().addClass(g)},i=function(){null!==e&&e.click(g)},j=function(a,b){""!==a&&""!==b&&e.each(function(){this.getAttribute("data-column-name")===a&&(h($(this).find("span"),b),f[a]=b)})};this.setOrdering=function(a,b){j(a,b)};!function(){if(d=$("#resultsTable thead"),0!==d.length&&(e=d.find(".js-sortable"),0!==e.length)){i();var a=FiltersHeap.getOrder();j(a.col,a.dir)}}()};
// File: stockScreener.js
!function(a){"use strict";function b(){e(a(".js-screener-save-popup").addClass("displayNone"))}function c(){var b=a("#secondaryFiltersCriterias"),c=b.find(".js-content");return a.trim(c.html())}function d(b){var c=b.attr("id")||b.data("id")||Date.now();b.data("id",c),setTimeout(function(){a(document).on("click."+c,function(a){b.is(a.target)||b.find(a.target).length||(e(b),b.addClass("displayNone"))})},1)}function e(b){a(document).off("click."+b.data("id"))}function f(a){return~a?a:"a"}window.toggleDel=function(b,c){c.stopPropagation();var d=a(b).data("screen-id");return a("#screen-id-"+d).toggleClass("delete"),!1},window.removeScreen=function(b,c){c.stopPropagation();var d=a(b).data("screen-id");a.post("/stockscreener/service/DeleteUserScreen",{screen_id:d},function(b){b=JSON.parse(b);var c=a("#showMyScreensSuccess");"success"==b.status?(a("#screen-id-"+b.screen_id).remove(),a(".js-my-screens-popup>.content>.screen").length?(a(".noScreensCont").addClass("displayNone"),a(".js-my-screens-popup").removeClass("noScreens")):(a(".noScreensCont").removeClass("displayNone"),a(".js-my-screens-popup").addClass("noScreens"))):c.text(window.eventScreenPopupParams.texts._failedDeleteScreen)},"text")},window.changeCriteria=function(b){var c=a(b).data("criteria");(new URLManipulator).updateURL(c),window.location.reload()},window.showInsertSuccess=function(){a(".myScreensCont").attr("data-tooltip",window.eventScreenPopupParams.texts._successfullyCreatedScreen),a(".myScreensCont").addClass("hover genToolTip"),a("#screen_name").val(""),setTimeout(function(){a(".myScreensCont").removeClass("hover genToolTip")},2500)};var g={wrapper:"rangeWrapper",title:"rangeTitle",min:"rangeMin",max:"rangeMax",range:"rangeBar",close:"bugCloseIcon",histWrapper:{w:146,h:18,classes:"rangeChart"}},h=new PrimaryFilters,i=new SecondaryFilters(g),j=new URLManipulator,k=new columnSorter;h.getAllPrimaryFiltersLables(),h.registerEvents(),FilterStocks.init(),FiltersHeap.addFilterValue("country",a("#countriesUL").find("li:first-child")[0].getAttribute("data-value")),a("#clearBtn").click(function(){return FilterStocks.disableSearch(),j.clearURL(),window.location.reload(),!1}),a("#myScreenSave").click(function(){if(a(this).is(".disabled"))return!1;var d=a("#screen_name").val(),e=c(),f=validator.validateByFields({screen_name:d,criteria:e},window.eventScreenPopupParams.rules);if(""==e)return void a(".sScreenrSavePopup").addClass("noCriteria");if(!1!==f){var g=new URLManipulator,e=g.getURLData(),h={screen_name:d,criteria:e};if(!window.siteData.userLoggedIn)return overlay.authCompleteAction={type:"stockScreener",actionData:h},void overlay.overlayLogin();a.post("/stockscreener/service/SaveNewScreen",h,function(a){if("success"==a)return showInsertSuccess(),void b();if("unauthorized"==a)return void overlay.overlayLogin();a=JSON.parse(a);for(var c in a)validator.showServerError(c,a[c])},"text")}}),a("#screen_name").on("input",function(b){a("#myScreenSave")[""==a(this).val()?"addClass":"removeClass"]("disabled")});var l=a(".js-top-screens");a(".js-show-top-screens").click(function(){l._toggleShow()}),a("#showMyScreens").click(function(b){a(".js-screener-save-popup").addClass("displayNone"),a(".js-top-screens").addClass("displayNone"),a(".js-my-screens-popup:visible").length?a(".js-my-screens-popup").addClass("displayNone"):a.get("/stockscreener/service/GetUserScreens",function(b){if("unauthorized"==b)return a(".js-my-screens-signin-popup").removeClass("displayNone"),void d(a(".js-my-screens-signin-popup"));var c=JSON.parse(b),e=a(".js-my-screens-popup"),f=a(".js-my-screens-popup .content");if(e.hasClass("displayNone")){var g="";for(var h in c)g+='<div id="screen-id-'+c[h].screen_id+'" class="screen pointer" onclick="changeCriteria(this)" data-criteria="'+c[h].criteria+'"><span class="deleteMessage"><span>'+window.eventScreenPopupParams.texts._deleteScreen+"</span><a data-screen-id="+c[h].screen_id+' onclick="toggleDel(this,event)" class="bugCloseIcon"></a><a data-screen-id='+c[h].screen_id+' onclick="removeScreen(this,event)" class="smallCheckmarkIcon"></a></span><a class="name">'+c[h].screen_name+'</a><p class="date">'+c[h].insert_date+'</p><span class="closer" data-screen-id="'+c[h].screen_id+'" onclick="toggleDel(this,event)"><i class="greyTrashIcon"></i></span></div>';""==g?e.addClass("noScreens"):(e.removeClass("noScreens"),f.html(g)),e.removeClass("displayNone")}else e.addClass("displayNone")},"text")}),a("#screen_name").keyup(function(b){b.keyCode=Math.max(b.keyCode,b.which),13==b.keyCode&&(a("#myScreenSave").click(),a(this).blur())}),a("#closeSaveScreenPopup").click(b),a("#saveBtn").click(function(b){var e=a(".sScreenrSavePopup");if(e.hasClass("displayNone")){var f=a("#screen_name").val(),g=c();validator.validateByFields({screen_name:f,criteria:g},window.eventScreenPopupParams.rules);var h=""==g?"addClass":"removeClass";a(".js-my-screens-popup").addClass("displayNone"),a(".js-top-screens").addClass("displayNone"),e[h]("noCriteria").removeClass("displayNone"),d(e),a(".sScreenrSavePopup input:visible").length&&(a("#myScreenSave").addClass("disabled"),a(".sScreenrSavePopup input:visible").val("").focus())}}),a(document).ready(function(){window.eventScreenPopupParams&&window.eventScreenPopupParams.pendingScreen&&showInsertSuccess()}),a(document).on("click",function(b){var c=a(".myScreensPopup");0==c.find(a(b.target)).length&&c.addClass("displayNone"),l.find(b.target).length||a(b.target).is(".js-show-top-screens")||l._hide()}),FilterStocks.registerSearchCallback("urlChange",function(){var a=FiltersHeap.serialize();j.updateURL(a)}),window.stockScreenerPaginationClick=function(a){FiltersHeap.setPageNum(a),FilterStocks.search()},a(".js-ss-custom-link").click(function(){var b=[];a(".js-filter-dropdown").each(function(){var c=a(this);b.push(c.data("filterType")+"::"+f(c.find(".js-search-input").attr("data-value")))}),b.push(a(this).data("filterParams")),window.location="/stock-screener/?sp="+b.join("|")+";1"});var m=j.getURLData();if(m.length>0){FilterStocks.disableSearch(),FiltersHeap.unserialize(m),FiltersHeap.setUpdateByURL(!0);var n=FiltersHeap.getOrder();return""!==n.col&&k.setOrdering(n.col,n.dir),h.buildSelection(),void i.buildSelection(function(){FilterStocks.enableSearch(),FilterStocks.search(),FiltersHeap.setUpdateByURL(!1)})}!0!==window.noDefaultlSearch&&FilterStocks.search(!0)}(window.jQuery);